<?xml version="1.0" encoding="Shift_JIS"?>
<!-- Copyright 2011 Miyako Komooka -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <title>iCalビューア２ ヘルプ</title>
    <style type="text/css">
	  h4 { margin: 0; text-decoration: underline }
	  h5 { margin: 0 }
	  body { max-width: 45em }
    </style>
  </head>
  <!-- body onload="init();" style="background-image: url( back.png )" -->
  <body>
    <h4>iCalビューア２について</h4>
    <div style="text-align:right">更新：2012/04/14</div>
    <p>
      <img src="images/MonthView.png" alt="iCalビューア"/><br />
      iCalビューワー２とは、iCalendar形式(拡張子ics)のファイルを元に、
      スケジュールをカレンダーに表示するためのサイドバー・
      ガジェットです。<br /><br />
      iCalendar形式は、スケジュールを管理するアプリ(例えばgoogleカレンダーや
      Lightningなど)やスポーツの試合予定などのイベントを通知する場合などに
      使われています。<br />
      こういったスケジュールなどの情報を、アプリを立ち上げなくても
      気軽に確認することができると便利かと思いこのガジェットを作ってみました。
      <br /><br />
      以前に、同じコンセプトのガジェット iCalビューアを公開していたのですが、
      今回silverlightを使って一から作り直したので、iCalビューア２としました。
      <br/>
      以前のバージョンに比べると、iCalファイルのサイズが大きい場合には
      処理が速くなっていると思いますが、メモリーは以前より
      使ってしまうので、環境によっては重くなるかもしれません。
    </p>
    <h4>主な機能</h4>
    <ul>
        <li>ローカルまたはインターネット上のiCalファイルについて、
          予定(VEvent)とタスク(VTODO)の基本的な内容を表示
          (タスクについては未処理のもののみ表示されます)
        </li>
        <li>インターネット上ではhttp,webcal,caldavプロトコルのサポート</li>
        <li>インターネット上ではログインが必要な場合にも対応
          (ベーシック認証、ダイジェスト認証)</li>
        <li>祝日用および予定・イベント用の二種類のiCalファイル</li>
        <li>画面表示の一部カスタマイズ</li>
    </ul>
    <h4>セットアップ</h4>
    <p>
      現状ではWindows7でのみ動作確認をしています。
      <br />
      iCal2.gadgetファイルをダウンロードし、ダブルクリックすると
      自動的にインストールされます。<br /><br />
      <img src="images/InstallSilverlight.png" alt="silverlightインストール"/>
      <br />
      もしこんな表示がされた場合は、silverlight5のランタイムが
      インストールされていません。<br/>
      表示されている画像をクリックすると自動でインストールされますので、
      その後このガジェットを終了させてから、もう一度起動してください。<br />
      <br />
      このガジェットでは、インターネットからiCalファイルを取得するときに
      .Net Framework 4を使っています。
      インターネットからiCalファイルの取得に失敗する場合は、
      <a href="http://www.microsoft.com/ja-jp/net/netfx4/download.aspx">
        .Net Framework 4 Client Profileのランタイム</a>
      をインストールしてください。
      (通常は、Windowsアップデートで自動インストールされているはずです)

    </p>
    <h4>操作方法</h4>
    <p>
      <img src="images/MonthView.png" alt="月表示のサンプル"/><br />
      スケジュールの表示は月ごとになっています。
      デフォルトでは、今日は背景がグレイで、
      予定のある日は<span style="font-weight:bold">太字</span>で表示されます。
      <br />
      期限または開始の時間が指定されている未処理のタスク(todo)は
      下線で表示されます。<br />
      <br />
      予定またはタスクのある日をクリックすると、その日の予定が表示されます。
      □が付いているのがタスク(todo)です。
      <br />
      <img src="images/DayView2.png" alt="日表示のサンプル" />
      <img src="images/DayView.png" alt="日表示のサンプル" /><br />
      月表示に戻すには、タイトル部分（日付が表示されているところ）をクリックします。<br />
      さらに、月表示のときにタイトル部分をクリックすると、年表示になります。<br />
      <img src="images/YearView.png" alt="年表示のサンプル" /><br />
      年表示では表示したい月を選択できます。<br />
      さらにタイトル部分をクリックすると１０年ごとの表示になります。<br />
      <img src="images/DecadeView.png" alt="１０年表示のサンプル" /><br />
    </p>
    <h5>アイコンの説明:</h5>
    <p>
      <img src="images/arrow4b-1l.png" alt="左矢印" />
      <img src="images/arrow4b-1r.png" alt="右矢印" /><br />
      前の月／次の月を表示します。
      日ごとの表示の場合は前の日／次の日になり、
      年表示では前の年／次の年となります。<br />
      <img src="images/ico_home1_8.png" alt="今月に戻る" /><br />
      今月の表示に戻ります。<br />
      <img src="images/ico_reload1_16.png" alt="再読込み" /><br />
      iCalendarファイルを再読込みします。
      iCalendarファイルは定期的にチェックされますが、
      それまで待てないときに使います<br />
      <img src="images/ico_clock2_8.png" alt="処理中" /><br />
      通常は表示されません。画面の描画処理中を示します。<br />
      内部的にはiCalendarファイルからその月に該当する予定を調べています。<br />
      <img src="images/ico_info1_8.png" alt="読み込み中" /><br />
      通常は表示されません。iCalendarファイルの読み込み中であることを示します。
    </p>
    <h4>iCalファイルのドラッグ＆ドロップ</h4>
    <p>
      ローカルのファイルや、ブラウザーで表示しているページのリンク
      をドラッグして、このガジェットにドロップすると、
      そのiCalendarファイルの内容が表示されます。
      
      <img src="images/DragDrop.png" alt="年表示のサンプル" /><br />
    </p>
    <h4>タスク(todo)一覧表示</h4>
    <p>
      <img src="images/GadgetButton.png" alt="ガジェットボタン" /><br />
      iCalビューア２にマウスを乗せた状態で右の方に出てくる
      まん中の□のようなボタンをクリックすると、
      下にタスク(todo)の一覧が表示されます。
      <br />
      <img src="images/TodoView.png" alt="ガジェットボタン" /><br />
      もう一度同じ操作をすると、タスク(todo)の一覧が非表示になります。<br />
      <br />
      カレンダー上では、タスク(todo)の期限または開始時間が指定された
      場合のみ表示されますが、ここでは期間に無関係にすべてのタスク(todo)
      が表示されます。<br />
      ただし、未処理状態のものだけが表示されます。
      処理済のタスク(todo)を表示する機能はありません。<br />
    </p>
    <h4>設定</h4>
    <p>
      iCalビューアにマウスを乗せた状態で右の方に出てくる、
      下のレンチのようなボタンをクリックすると設定画面が出てきます。<br />
      設定画面が表示されるのに、数秒かかることがあります。<br />
      <img src="images/setting1.png" alt="設定画面1" /><br />
      「カレンダー」タブでは、予定を表示するためのiCalendarファイルと
      祝日用のiCalendarファイルを設定できます。<br /><br />
      ローカルのファイルは、参照ボタンからも選択できます。<br />
      インターネット上のファイルの場合は、http://....と設定してください。
      プロトコルによって、httpの部分をwebcal, caldavに置き換えてください。
      SSLアクセスの場合は、https,webcals,caldavsとなります。<br />
      インターネット上のファイルを取得するのに認証が必要な場合は、
      ユーザーIDとパスワードを設定してください。<br /><br />
      例としてgoogleカレンダーの場合には、ファイル名に
      caldavs://www.google.com/calendar/dav/xyz@gmail.com/events/を、
      ユーザーIDにxyz@gmail.comを、パスワードにgoogleアカウントの
      パスワードを設定します。xyzはあなたのgmailアドレスと置き換えてください。
      <br /><br />
      接続テストのボタンをクリックすると、
      iCalendarファイルに正常にアクセスできるか調べることができます。<br />
      それぞれのiCalendarファイルに正常にアクセスできれば、OKと表示されます。
      それ以外の場合は、エラー情報が表示されます。<br />
      クリアボタンは、接続テストの結果表示を消去します。<br />
      <br />
      <img src="images/setting2.png" alt="設定画面2" /><br />
      「表示」タブでは、日付の色や背景色などを設定できます。<br /><br />
      通常の文字色は、今日と予定日以外の日の文字の色を選択できます。
      ただし、土曜日(青)、日祝日（赤）の色は変更できません。
      今日、予定日、タスク(Todo)の文字色も同様に選択できます。
      文字の背景色も同様に選択できます。<br />
      太字・下線にする場合はそれぞれチェックしてください。<br />
      <br />

      <img src="images/setting3.png" alt="設定画面3" /><br />
      「その他」タブでは、以下の項目を設定できます。<br />
      <br />
      カレンダーの自動読み込み間隔は、予定日用と祝日用の
      iCalendarファイルを読み込む間隔を分単位で指定します。
      ファイルの読み込み間隔に０を指定すると再読込みしません。<br />
      <br />
      日付表示やタスク(todo)一覧で表示される予定・タスクをクリックした時に、
      アプリケーションを起動したり、ブラウザーで特定のページを開くように
      するための設定です。<br />
      アプリケーションのパスや、ブラウザーで表示するページのURL(http://...)
      を指定してください。アプリケーションの場合で引数がある場合には、
      引数欄に記述してください。URLの場合には無視されます。<br />
      コマンドと引数に$Y,$M,$D,$Uを指定すると、その予定やタスクの
      年、月、日、UIDに変換された内容を元にコマンドを実行します。<br />
      年月日は、日付表示の場合はその日付、
      タスク一覧の場合にはそのタスクの期限などから取得します。<br />
      UIDは、予定やタスクに設定されている固有のIDです。<br />
      <br />      
      月表示や日表示でのタイトルのフォーマットを設定できます。<br />
      設定方法の詳細は、
      <a href="http://msdn.microsoft.com/ja-jp/library/8kb3ddd4%28v=vs.95%29.aspx">
        silverlightのカスタム日時書式</a>を参照してください。

    </p>

    <h4>その他仕様など</h4>
    <p>
      タイムゾーンについて。<br />
      iCalビューアではiCalendarファイルのタイムゾーンをチェックし、
      システムのタイムゾーンに変換して表示しています。
      iCalendar形式では必ずタイムゾーンを定義しなければいけないのですが、
      一部ではタイムゾーンを定義しないで使っている場合があるようです。
      iCalビューアでは、一部のタイムゾーンについてだけ定義されていなくても
      機能するようにしてあります。そのタイムゾーンとは以下のものです。
    </p>
    <ul>
	<li>Asia/Japan </li>
	<li>US/Central</li>
	<li>US/Eastern</li>
	<li>US/Mountain</li>
	<li>US/Pacific</li>
    </ul>
    <p>
      これ以外だと、グリニッジ標準時間として判断するので、時間が正しく表示されないことがあります。
    </p>
    <p>
      iCalendar形式はRFC5545で定義されています。<br />
      iCalビューア２ではこのうちVEVENTコンポーネントとVTODOコンポーネントの
      基本的な内容を表示しています。
      VJOURNALは無視しています。<br />
      繰り返しの指定についてもほぼ対応していると思います。<br />
    </p>
    <p>
      スクロール・バーについて<br />
      日表示などでたくさんの予定がある場合にはスクロール・バーが表示される
      のですが、ドラッグでのスクロールが動作しません。<br />
      クリックでのスクロールは可能です。<br />
    </p>
    <p>
      インターネット上のiCalファイルへのアクセスについて、<br />
      iCalビューア２では同梱のWebLoader.exeという実行ファイルを使っています。
      これを動かすのに、.Net Framework 4のランタイムが必要になります。<br />
      一般的にはjavascriptのXMLHttpRequestを使う方法を取ると思いますが、
      私のテストした範囲ではiCalファイルのURLがリダイレクトされていると
      うまく取得できないことがあったので、こうなりました。<br />
    </p>
    <h4>謝辞</h4>
    <p>
      最後になりましたが、このガジェットは<a href="http://dots-design.com">DOTS・DESIGN</a>からたくさんのアイコンを使わせていただきました。<br />
      ありがとうございます。
    </p>
    <h4>リリース履歴</h4>
    <p>
      2012.4.14 v1.0.0 最初のリリース
    </p>

  </body>
</html>
  
   
